<html>
  <head>
    <title>Product Images QA</title>
    <meta charset="UTF-8" />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/styles.css') }}"
    />
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="{{ url_for('static', filename='images/favicon.ico') }}"
    />
    <script
      src="{{ url_for('static', filename='js/slideshow.js') }}"
      defer
    ></script>
    <script
      src="{{ url_for('static', filename='js/superscript.js') }}"
      defer
    ></script>
    <script
      src="{{ url_for('static', filename='js/mouseover.js') }}"
      defer
    ></script>
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick-theme.css"
    />
    <link
      rel="icon"
      href="{{ url_for('static', filename='images/favicon.ico') }}"
      type="image/x-icon"
    />
  </head>

  <body>
    <center><h3>Product Images QA</h3></center>

    <form method="POST" action="{{ url_for('export_excel') }}">
      <!-- Properly serialize sku_details to JSON with double quotes -->
      <input type="hidden" name="sku_details" value='{{ sku_details|tojson }}'>
      <button type="submit" class="btn btn-primary">Export</button>
  </form>


    <div id="ATF">
      <table id="tech-specs">
        <thead>
          <tr>
            <th>SKU</th>
            <th>SKU Name</th> <!-- New column for SKU Name -->
            <th>Pixel Width Count</th>
            <th>Pixel Height Count</th>
            <th>Orientation Count</th>
            <th>Product Color Count</th>
            <th>Document Type Detail Count</th>
            <th>Image URL HTTP Count</th>
            <th>Image URL HTTPS Count</th>
            <th>Background Count</th>
            <th>Master Object Name Count</th>
            <th>Type Count</th>
            <th>Total Images</th>
            <th>Notes</th> <!-- New column for Notes -->
          </tr>
        </thead>
        <tbody>
          {% for sku in sku_details %}
            <tr>
              <td>{{ sku.sku }}</td>
              <td>{{ sku.sku_name }}</td> <!-- Display SKU Name here -->
              <td style="color: {{ 'red' if sku.counts.pixelWidth_count == 0 else 'inherit' }}">{{ sku.counts.pixelWidth_count }}</td>
              <td style="color: {{ 'red' if sku.counts.pixelHeight_count == 0 else 'inherit' }}">{{ sku.counts.pixelHeight_count }}</td>
              <td style="color: {{ 'red' if sku.counts.orientation_count == 0 else 'inherit' }}">{{ sku.counts.orientation_count }}</td>
              <td style="color: {{ 'red' if sku.counts.productColor_count == 0 else 'inherit' }}">{{ sku.counts.productColor_count }}</td>
              <td style="color: {{ 'red' if sku.counts.documentTypeDetail_count == 0 else 'inherit' }}">{{ sku.counts.documentTypeDetail_count }}</td>
              <td style="color: {{ 'red' if sku.counts.imageUrlHttp_count == 0 else 'inherit' }}">{{ sku.counts.imageUrlHttp_count }}</td>
              <td style="color: {{ 'red' if sku.counts.imageUrlHttps_count == 0 else 'inherit' }}">{{ sku.counts.imageUrlHttps_count }}</td>
              <td style="color: {{ 'red' if sku.counts.background_count == 0 else 'inherit' }}">{{ sku.counts.background_count }}</td>
              <td style="color: {{ 'red' if sku.counts.masterObjectName_count == 0 else 'inherit' }}">{{ sku.counts.masterObjectName_count }}</td>
              <td style="color: {{ 'red' if sku.counts.type_count == 0 else 'inherit' }}">{{ sku.counts.type_count }}</td>
              <td style="color: {{ 'red' if sku.image_count == 0 else 'inherit' }}">{{ sku.image_count }}</td>
              <td>{{ sku.notes }}</td> <!-- Display notes (duplicate orientation info) -->
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Button to return to the previous page -->
    <div style="margin-top: 20px;">
      <button onclick="window.history.back()">Return</button>
    </div>
  </body>
</html>
